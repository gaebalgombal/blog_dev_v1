# 선릉맥주(4) 상품리스트 GET의 에러 처리

**2001년 6월 20일2001년 6월 20일**

**Written By [anne shirley](https://www.todayitanzada.com/?author=600ccc46fca7d614a7dbe498)**

**1. 오류 처리**

- Product가 존재하지 않는 경우
  - 대응 (1)
    GET으로 가져온 뒤, 존재하지 않는 경우 Does Not Exist 발생 >>Exception 처리 >> 오류 메세지 반환
  - 대응(2)
    filter로 가져온 뒤, 존재하는지 여부를 if로 체크하고, 없는 경우 오류 메세지 반환
  - 대응(3)
    filter로 가져온 뒤, 있든 없든 결과물을 배열로 반환 >> 존재하지 않으면 빈 배열 반환
  - 최종 선택
    대응(3) 어차피 배열 / NoneType(빈배열)로 분기된다면, 쓸데없이 조건문으로 분기하거나/Exception으로 분기해줄 필요가 없음
    즉, 분기는 꼭 ‘조건문’으로만 이루어지는 것이 아니다.
    If 조건문으로도, Try/Except 예외처리로도, 단순 결과물로도 분기될 수 있다.
    그리고 가능하다면 (그리고 특히 조회의 경우), 결과물로 알아서 분기되는 것이 가장 깔끔하다.
    (결과물을 배열에 담는데, 결과물이 있으면 >> 요소가 담김, 없으면 >> 빈 배열)
- Product Image가 존재하지 않는 경우
  Product와 역시 마찬가지로 결과물로 알아서 분기되도록 할 수 있다.
- 페이지의 범위를 벗어난 경우
  역시 마찬가지로 결과물로 알아서 분기되도록 할 수 있다. (3페이지까지 밖에 상품이 없는데, 4페이지의 결과물을 요청한 경우, 빈 배열이 반환됨)
  - 하나 더 생각해보기
    다만, 우리 선릉맥주 기획에서는 처음부터 ‘마지막 페이지인지’ 여부를 같이 보내주기로 했는데,
    마지막 페이지인 경우 ‘더보기’ 버튼을 비활성화 시켜, 애초에 페이지 범위를 벗어난 요청이 들어오지 않도록 하기 위해서였다.
    따라서 ‘is_last_page’라는 변수에, 마지막 페이지인지 여부를 판단하는 조건문을 할당해, true/false를 결과물에 같이 보내주었다.

**2. 오류 처리의 목적: 유저에게 무엇을 제공할 것인가**

여러 오류에 대해(에러든, 서비스 정책상 오류든) 각각 적절한 결과값를 반환해주는 궁극적인 목적은, 프런트에서 각 결과값에 따라 적절한 결과를 유저에게 제공하기 위함이다.

프로젝트를 하면서 이 부분을 새삼 깨달았다.

상품 리스트 GET 기능을 구현하면서, 각 오류 상황과, 리턴 메세지, 그리고 리턴메세지에 따라 유저에게 무엇을 제공할 지까지 생각할 수 있었다.

그리고 정말 시스템상 에러가 아니라면, 최대한 결과값을 보여주도록 설정했다.

예를 들어, 페이지 Query Param의 값이 들어오지 않았다면, 오류 메세지를 반환하기보다는 첫 페이지에 해당하는 제품이 보여질 수 있도록 설정했다.

이번 기능에서는 필요 없었지만, 만약 실제 에러라면(없는 상품의 상세 페이지를 요청한다든지 등등), 프런트에서 역시 오류 메세지를 보여주기보다는 상품 메인으로 리다이렉트 시킨다든지 등등 처리가 필요할 듯하다.

- 그래서 상품 리스트 GET의 경우, 최종적으로 유저에게 무엇이 제공되었나
  - 제품이 없는 경우
    백 : 빈 배열 반환 >>프: “카테고리에 해당하는 상품이 없습니다.” 안내 문구가 뜬 빈 페이지 노출
  - 제품 이미지가 없는 경우
    백 : NoneType 반환 >> 프: 디폴트 이미지가 보여지도록 처리
  - 페이지 Query Param 값이 안 들어온 경우
    백: 디폴트 값을 설정해, 첫 페이지에 해당하는 데이터 반환 >> 프 : 첫 페이지 노출

`class ProductListView(View):
    def get(self, request):
        offset        = int(request.GET.get('offset',0)) *#디폴트 0 설정*
        limit         = int(request.GET.get('limit',6)) *#디폴트 6 설정*`

**3. 결론: 무엇을 배웠나**

- 오류 처리의 목적은, 각 결과값에 대해 프런트가 유저에게 적절한 결과값을 제공하기 위함이다.
- 데이터 GET에 대해, 데이터가 없는 경우를 항상 염두에 두고 ‘디폴트 값’을 설정하자. ( 물론 필요없는 경우에는 최종적으로 설정하지 않겠지만, 처음에는 생각해보자.)
- 정말 필요한 에러 처리만 할 수 있도록 추려내자. ( Django ORM에서 Filter 메서드를 쓰는데 Does Not Exist나 Multiple Objects Returned를 처리하는 건 뻘짓)
